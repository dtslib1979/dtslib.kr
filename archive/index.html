<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>KR ER RUN ARCHIVE â€” UncleParksy</title>
<meta name="description" content="ë²ˆëœ©ì´ëŠ” ì•„ì´ë””ì–´ì™€ ì—í”¼ì†Œë“œê°€ ì–‘ì‚° ì§ì „ ì‹œë“œë¡œ ë³´ê´€ë˜ëŠ” ER Run Archive" />

<!-- Same fonts as main page -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Pirata+One&family=Philosopher:wght@400;700&display=swap" rel="stylesheet">

<style>
/* Same root variables as main page */
:root{
  --primary-gold:#d4af37; --dark-gold:#b8860b; --light-gold:#f4e4aa;
  --parchment:#f7f3e8; --dark-parchment:#e8dcc0;
  --ink:#1a0f0a; --ink-2:#2d1b12; --ink-3:#4a2c1a;
  --purple:#6a4c93; --blue:#4a90e2; --red:#c44536;
  --shadow-d:rgba(26,15,10,.4); --shadow-m:rgba(26,15,10,.2); --shadow-l:rgba(26,15,10,.1);
  --ring:rgba(0,0,0,.08);
}

/* Base styles - same as main page */
*{box-sizing:border-box}
html,body{margin:0;padding:0}
html{scroll-behavior:smooth}
body{
  font-family: 'Philosopher', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  color:var(--ink);
  background:
    radial-gradient(circle at 15% 25%, rgba(212,175,55,.05) 0%, transparent 40%),
    radial-gradient(circle at 85% 75%, rgba(106,76,147,.04) 0%, transparent 40%),
    linear-gradient(135deg, var(--parchment) 0%, var(--dark-parchment) 100%);
  min-height:100vh; overflow-x:hidden; position:relative;
}

/* Parchment grain effect */
body::before{
  content:""; position:fixed; inset:0; z-index:1; pointer-events:none;
  background:
    repeating-linear-gradient(45deg, transparent,transparent 1px, rgba(212,175,55,.015) 1px, rgba(212,175,55,.015) 2px),
    repeating-linear-gradient(-45deg, transparent,transparent 1px, rgba(74,44,26,.015) 1px, rgba(74,44,26,.015) 2px);
}

/* Korean particles */
.korean-particle{
  position:fixed; z-index:4; pointer-events:none; 
  font-family: 'Philosopher', serif; font-weight:300;
  color: var(--primary-gold); opacity:0;
  animation: floatUp 8s linear infinite;
}
@keyframes floatUp{
  0%{opacity:0; transform:translateY(calc(100vh + 20px)) scale(.6) rotate(0deg)}
  5%{opacity:.4} 
  95%{opacity:.1}
  100%{opacity:0; transform:translateY(-50px) scale(1.1) rotate(180deg)}
}

/* Header */
.archive-header{
  position:relative; z-index:10; padding:clamp(1rem,4vw,2rem);
  text-align:center; margin-bottom:clamp(1rem,3vw,2rem);
}

.archive-title{
  font-family:'Pirata One', cursive; 
  font-size:clamp(2.2rem,6vw,3.8rem);
  background:linear-gradient(135deg, var(--primary-gold) 0%, var(--light-gold) 25%, var(--dark-gold) 50%, var(--purple) 75%, var(--primary-gold) 100%);
  background-size:200% 200%; 
  -webkit-background-clip:text; background-clip:text; 
  -webkit-text-fill-color:transparent;
  text-shadow:2px 2px 4px var(--shadow-m), 0 0 20px rgba(212,175,55,.3);
  letter-spacing:clamp(1px,.3vw,3px); margin:0 0 .5rem; 
  line-height:1.1; text-transform:uppercase; 
  animation:titleShine 8s ease-in-out infinite;
}
@keyframes titleShine{0%,100%{background-position:0% 50%} 50%{background-position:100% 50%}}

.archive-subtitle{
  font-size:clamp(.9rem,2.2vw,1.1rem); 
  color:var(--ink-2); opacity:.85; margin:0 0 1.5rem;
}

/* ğŸ“Š Counter Display */
.file-counter{
  position:relative; z-index:10;
  text-align:center; margin:1rem 0;
  padding:1rem; border-radius:20px;
  background:linear-gradient(135deg, rgba(212,175,55,.15), rgba(106,76,147,.1));
  border:2px solid rgba(212,175,55,.3);
  box-shadow:0 4px 16px var(--shadow-l);
}

.counter-text{
  font-family:'Philosopher', serif; font-weight:700;
  font-size:clamp(1rem,2.5vw,1.3rem);
  color:var(--ink);
  margin:0;
}

.counter-number{
  display:inline-block;
  font-family:'Pirata One', cursive;
  font-size:clamp(1.5rem,4vw,2rem);
  background:linear-gradient(135deg, var(--primary-gold), var(--purple));
  -webkit-background-clip:text; background-clip:text;
  -webkit-text-fill-color:transparent;
  margin:0 .5rem;
  text-shadow:0 0 10px rgba(212,175,55,.5);
}

/* Navigation & Controls */
.archive-controls{
  position:relative; z-index:10; 
  display:flex; justify-content:space-between; align-items:center; 
  flex-wrap:wrap; gap:1rem; padding:0 clamp(1rem,4vw,2rem);
  margin-bottom:clamp(1rem,3vw,2rem);
}

.back-link{
  font-family:'Philosopher', serif; font-weight:700; 
  text-decoration:none; color:var(--ink);
  padding:.6rem 1.2rem; border-radius:20px;
  background:linear-gradient(135deg, rgba(212,175,55,.1), rgba(212,175,55,.2));
  border:2px solid rgba(212,175,55,.3);
  transition:all .3s ease;
}
.back-link:hover{
  background:linear-gradient(135deg, rgba(212,175,55,.2), rgba(212,175,55,.3));
  border-color:var(--primary-gold);
  transform:translateY(-2px);
}

.sort-controls{
  display:flex; gap:.5rem; flex-wrap:wrap;
}
.sort-btn{
  padding:.5rem 1rem; border:none; border-radius:15px; cursor:pointer;
  font-family:'Philosopher', serif; font-weight:700; font-size:.85rem;
  background:linear-gradient(135deg, rgba(247,243,232,.8), rgba(232,220,192,.9));
  color:var(--ink-2); border:2px solid rgba(212,175,55,.2);
  transition:all .3s ease; text-transform:uppercase; letter-spacing:.5px;
}
.sort-btn.active{
  background:linear-gradient(135deg, var(--primary-gold), var(--dark-gold));
  color:var(--ink); border-color:var(--dark-gold);
  box-shadow:0 4px 12px rgba(212,175,55,.4);
}
.sort-btn:hover{
  transform:translateY(-1px);
  box-shadow:0 6px 16px rgba(212,175,55,.3);
}

/* Treasure scroll container */
.treasure-container{
  position:relative; z-index:10; 
  max-width:1200px; margin:0 auto; padding:0 clamp(1rem,4vw,2rem);
}

.scroll-viewer{
  position:relative; overflow:hidden; 
  background:linear-gradient(135deg, rgba(247,243,232,.95) 0%, rgba(232,220,192,.92) 50%, rgba(228,216,188,.9) 100%);
  backdrop-filter:blur(18px); border-radius:26px; 
  border:3px solid rgba(212,175,55,.4);
  box-shadow:0 34px 110px var(--shadow-m), inset 0 2px 6px rgba(255,255,255,.5), inset 0 -2px 6px rgba(212,175,55,.15);
  padding:clamp(1.5rem,5vw,3rem);
}

/* Treasure cards grid */
.treasure-grid{
  display:grid; 
  grid-template-columns:1fr;
  gap:clamp(0.8rem,2vw,1.2rem);
  margin-bottom:2rem;
}

/* Individual treasure cards - more compact for archive feel */
.treasure-card{
  position:relative; min-height:100px; 
  background:linear-gradient(135deg, rgba(255,255,255,.2) 0%, rgba(247,243,232,.95) 30%, rgba(232,220,192,.9) 100%);
  border-radius:12px; padding:clamp(0.7rem,2vw,1rem); 
  border:2px solid rgba(212,175,55,.25);
  cursor:pointer; text-decoration:none; color:inherit;
  transition:all .35s ease;
  box-shadow:0 4px 12px var(--shadow-l);
  
  /* Random rotation and offset for "ì‚ëš¤ë¹¼ëš¤" effect */
  transform:rotate(var(--random-rotate)) translate(var(--random-x), var(--random-y));
}

.treasure-card::before{
  content:""; position:absolute; inset:0; left:-100%;
  background:linear-gradient(90deg, transparent, rgba(212,175,55,.15), transparent);
  transition:left .55s ease; z-index:1; border-radius:12px;
}

.treasure-card:hover{
  transform:rotate(0deg) translate(0, -4px) scale(1.01);
  border-color:var(--primary-gold);
  box-shadow:0 8px 24px var(--shadow-d), 0 0 20px rgba(212,175,55,.35);
}
.treasure-card:hover::before{left:100%}

.card-content{
  position:relative; z-index:2; height:100%; 
  display:flex; flex-direction:column; justify-content:space-between;
}

.card-label{
  display:inline-block; padding:.2rem .6rem; border-radius:10px; 
  font-size:.7rem; font-weight:700; text-transform:uppercase; 
  letter-spacing:.5px; margin-bottom:.5rem;
  background:linear-gradient(135deg, var(--purple), #8a2be2); 
  color:#fff; text-shadow:1px 1px 2px rgba(0,0,0,.3);
}

.card-title{
  font-weight:700; font-size:clamp(0.95rem,2.2vw,1.15rem); 
  color:var(--ink); margin:0 0 .4rem; line-height:1.3;
}

.card-comment{
  font-size:.8rem; color:var(--ink-2); opacity:.85; 
  margin:0 0 .4rem; line-height:1.3;
  font-style:italic;
}

.card-date{
  font-size:.8rem; color:var(--ink-3); opacity:.7; 
  margin-top:auto; font-style:italic;
}

/* Pagination */
.pagination{
  display:flex; justify-content:center; align-items:center; 
  gap:1rem; margin-top:2rem; flex-wrap:wrap;
}

.page-btn{
  padding:.7rem 1.2rem; border:none; border-radius:20px; cursor:pointer;
  font-family:'Philosopher', serif; font-weight:700;
  background:linear-gradient(135deg, rgba(247,243,232,.8), rgba(232,220,192,.9));
  color:var(--ink-2); border:2px solid rgba(212,175,55,.2);
  transition:all .3s ease; min-width:48px;
}
.page-btn:hover:not(:disabled){
  background:linear-gradient(135deg, var(--primary-gold), var(--dark-gold));
  color:var(--ink); transform:translateY(-2px);
  box-shadow:0 6px 16px rgba(212,175,55,.4);
}
.page-btn:disabled{
  opacity:.4; cursor:not-allowed;
}

.page-dots{
  display:flex; gap:.5rem;
}
.page-dot{
  width:12px; height:12px; border-radius:50%; border:none; cursor:pointer;
  background:rgba(212,175,55,.3); transition:all .3s ease;
}
.page-dot.active{
  background:var(--primary-gold); transform:scale(1.3);
}

.page-info{
  font-size:.9rem; color:var(--ink-3); 
  padding:.5rem 1rem; opacity:.8;
}

/* Loading state */
.loading-message{
  text-align:center; padding:3rem; font-size:1.1rem; color:var(--ink-2);
}

/* Error state */
.error-message{
  text-align:center; padding:2rem; color:var(--red);
  background:rgba(196,69,54,.1); border-radius:12px; margin:1rem 0;
}

/* Mobile touch interactions */
@media (pointer: coarse){
  .treasure-card{
    min-height:90px;
  }
  .treasure-card:hover{
    transform:rotate(var(--random-rotate)) translate(var(--random-x), var(--random-y));
  }
  .treasure-card:active{
    transform:rotate(0deg) translate(0, -2px) scale(1.01);
  }
}

/* Tablet layout - 2 columns */
@media (min-width:768px){
  .treasure-grid{
    grid-template-columns:repeat(2, 1fr);
    gap:1rem;
  }
}

/* Desktop layout - 3 columns */
@media (min-width:1024px){
  .treasure-grid{
    grid-template-columns:repeat(3, 1fr);
    gap:1.2rem;
  }
}

/* Reduced motion */
@media (prefers-reduced-motion:reduce){
  .korean-particle{display:none}
  *{animation-duration:.01ms !important; animation-iteration-count:1 !important}
  .treasure-card{transform:none !important}
}

/* Print styles */
@media print{
  .korean-particle, .archive-controls, .pagination{display:none}
  body{background:#fff; color:#000}
  .treasure-card{box-shadow:none; border:1px solid #ccc}
}
</style>
</head>

<body>
  <!-- Korean floating particles -->
  <div id="korean-particles"></div>

  <!-- Header -->
  <header class="archive-header">
    <h1 class="archive-title">ğŸŒ± KR ER RUN ARCHIVE</h1>
    <p class="archive-subtitle">ë²ˆëœ©ì´ëŠ” ì•„ì´ë””ì–´ì™€ ì—í”¼ì†Œë“œê°€ ì–‘ì‚° ì§ì „ ì‹œë“œë¡œ ë³´ê´€ë˜ëŠ” ê³µê°„</p>
  </header>

  <!-- ğŸ“Š File Counter Display -->
  <div class="file-counter">
    <p class="counter-text">
      ì´ <span class="counter-number" id="file-count">0</span>ê°œì˜ ER ì‹œë“œê°€ ë³´ê´€ë˜ì–´ ìˆìŠµë‹ˆë‹¤
    </p>
  </div>

  <!-- Controls -->
  <nav class="archive-controls">
    <a href="../index.html" class="back-link">â† ê·¸ë¦¬ëª¨ì–´ë¡œ ëŒì•„ê°€ê¸°</a>
    
    <div class="sort-controls">
      <button class="sort-btn active" data-sort="random">ğŸ² ì˜ê°ìš© ëœë¤</button>
      <button class="sort-btn" data-sort="newest">ğŸ“… ìµœì‹ ìˆœ</button>
      <button class="sort-btn" data-sort="oldest">ğŸ“œ ì˜¤ë˜ëœìˆœ</button>
      <button class="sort-btn" data-sort="title">ğŸ”¤ ì œëª©ìˆœ</button>
    </div>
  </nav>

  <!-- Main treasure container -->
  <main class="treasure-container">
    <div class="scroll-viewer">
      <div id="loading" class="loading-message">
        ğŸŒ± ER ì‹œë“œ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
      </div>
      
      <div id="error" class="error-message" style="display:none">
        âŒ ER ì‹œë“œ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë‚˜ì¤‘ì— ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.
      </div>
      
      <div id="content" style="display:none">
        <div class="treasure-grid" id="treasure-grid">
          <!-- Cards will be populated by JavaScript -->
        </div>
        
        <!-- Pagination -->
        <div class="pagination" id="pagination">
          <button class="page-btn" id="prev-btn">ì´ì „</button>
          <div class="page-dots" id="page-dots"></div>
          <div class="page-info" id="page-info"></div>
          <button class="page-btn" id="next-btn">ë‹¤ìŒ</button>
        </div>
      </div>
    </div>
  </main>

  <script>
    // State management
    let allItems = [];
    let filteredItems = [];
    let currentPage = 0;
    const itemsPerPage = 10;
    let currentSort = 'random';

    // Korean characters for particles
    const koreanChars = [
      'ê°€', 'ë‚˜', 'ë‹¤', 'ë¼', 'ë§ˆ', 'ë°”', 'ì‚¬', 'ì•„', 'ì', 'ì°¨', 'ì¹´', 'íƒ€', 'íŒŒ', 'í•˜',
      'í•œ', 'ê¸€', 'ì´', 'ì•¼', 'ê¸°', 'ë¸”', 'ë¡œ', 'ê·¸', 'ì´', 'ì•¼', 'ê¸°'
    ];

    // HTML escape helper to prevent XSS
    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', async () => {
      await loadManifest();
      initSortControls();
      initKoreanParticles();
      initTouchSupport();
    });

    // ğŸ¯ Load manifest.archive.json (ì•„ì¹´ì´ë¸Œ ì „ìš© ë§¤ë‹ˆí˜ìŠ¤íŠ¸)
    async function loadManifest() {
      try {
        console.log('ğŸ“¡ Fetching manifest.archive.json...');
        const response = await fetch('../assets/manifest.archive.json');
        
        if (!response.ok) {
          throw new Error(`HTTP ${response.status}: ${response.statusText}`);
        }
        
        const data = await response.json();
        console.log('âœ… Manifest loaded:', data);
        
        allItems = data.items || [];
        console.log(`ğŸ“Š Found ${allItems.length} items`);
        
        // ğŸ”¥ Update file counter
        updateFileCounter(data.count || allItems.length);
        
        // Apply initial sort
        applySort(currentSort);
        renderCurrentPage();
        
        document.getElementById('loading').style.display = 'none';
        document.getElementById('content').style.display = 'block';
        
        console.log('ğŸ‰ Archive loaded successfully!');
        
      } catch (error) {
        console.error('âŒ Error loading manifest:', error);
        document.getElementById('loading').style.display = 'none';
        document.getElementById('error').style.display = 'block';
        
        // Show error details
        const errorDiv = document.getElementById('error');
        errorDiv.innerHTML = `
          âŒ ER ì‹œë“œ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.<br>
          <small style="opacity:0.7">ì˜¤ë¥˜: ${error.message}</small><br>
          <small style="opacity:0.7">ê²½ë¡œ: ../assets/manifest.archive.json</small>
        `;
      }
    }

    // ğŸ“Š Update file counter display
    function updateFileCounter(count) {
      const counterElement = document.getElementById('file-count');
      if (counterElement) {
        counterElement.textContent = count;
        console.log(`ğŸ“Š Counter updated: ${count} files`);
      }
    }

    // Sort functions
    function applySort(sortType) {
      currentSort = sortType;
      
      switch (sortType) {
        case 'random':
          filteredItems = [...allItems].sort(() => Math.random() - 0.5);
          break;
        case 'newest':
          filteredItems = [...allItems].sort((a, b) => 
            new Date(b.date || 0) - new Date(a.date || 0)
          );
          break;
        case 'oldest':
          filteredItems = [...allItems].sort((a, b) => 
            new Date(a.date || 0) - new Date(b.date || 0)
          );
          break;
        case 'title':
          filteredItems = [...allItems].sort((a, b) => 
            (a.title || '').localeCompare(b.title || '', 'ko')
          );
          break;
        default:
          filteredItems = [...allItems];
      }
      
      currentPage = 0; // Reset to first page
    }

    // Render current page
    function renderCurrentPage() {
      const startIdx = currentPage * itemsPerPage;
      const endIdx = startIdx + itemsPerPage;
      const pageItems = filteredItems.slice(startIdx, endIdx);
      
      const grid = document.getElementById('treasure-grid');
      grid.innerHTML = '';
      
      pageItems.forEach((item, index) => {
        const card = createTreasureCard(item, startIdx + index);
        grid.appendChild(card);
      });
      
      updatePagination();
    }

    // ğŸ”¥ Create treasure card element (ê²½ë¡œ ì²˜ë¦¬ ìˆ˜ì •)
    function createTreasureCard(item, index) {
      const card = document.createElement('a');
      card.className = 'treasure-card';
      
      // ğŸ¯ ê²½ë¡œ ì²˜ë¦¬ ìˆ˜ì •: ì•ì˜ "/" ì œê±° í›„ "../" ì¶”ê°€
      let cleanPath = item.path;
      if (cleanPath.startsWith('/')) {
        cleanPath = cleanPath.substring(1); // ë§¨ ì• "/" ì œê±°
      }
      card.href = '../' + cleanPath; // "../archive/filename.html" í˜•íƒœê°€ ë¨
      
      // Remove target="_blank" for better mobile navigation experience
      // card.target = '_blank';
      
      console.log(`ğŸ”— Card link: ${card.href} (ì›ë³¸: ${item.path})`);
      
      // Random rotation and translation for subtle "ì‚ëš¤ë¹¼ëš¤" effect (reduced for compact layout)
      const rotate = (Math.random() - 0.5) * 2; // -1deg to 1deg
      const translateX = (Math.random() - 0.5) * 4; // -2px to 2px
      const translateY = (Math.random() - 0.5) * 4; // -2px to 2px
      
      card.style.setProperty('--random-rotate', `${rotate}deg`);
      card.style.setProperty('--random-x', `${translateX}px`);
      card.style.setProperty('--random-y', `${translateY}px`);
      
      const formattedDate = item.date 
        ? new Date(item.date).toLocaleDateString('ko-KR', {
            year: 'numeric',
            month: 'long',
            day: 'numeric'
          })
        : 'ë‚ ì§œ ë¯¸ìƒ';
      
      // Build comment HTML if present (with XSS protection)
      const commentHtml = item.comment 
        ? `<p class="card-comment">${escapeHtml(item.comment)}</p>` 
        : '';
      
      // Escape title for XSS protection
      const safeTitle = escapeHtml(item.title || 'ì œëª© ì—†ìŒ');
      
      card.innerHTML = `
        <div class="card-content">
          <div>
            <span class="card-label">ER RUN</span>
            <h3 class="card-title">${safeTitle}</h3>
            ${commentHtml}
          </div>
          <div class="card-date">${formattedDate}</div>
        </div>
      `;
      
      return card;
    }

    // Update pagination controls
    function updatePagination() {
      const totalPages = Math.ceil(filteredItems.length / itemsPerPage);
      
      // Update buttons
      const prevBtn = document.getElementById('prev-btn');
      const nextBtn = document.getElementById('next-btn');
      
      prevBtn.disabled = currentPage === 0;
      nextBtn.disabled = currentPage >= totalPages - 1;
      
      prevBtn.onclick = () => {
        if (currentPage > 0) {
          currentPage--;
          renderCurrentPage();
        }
      };
      
      nextBtn.onclick = () => {
        if (currentPage < totalPages - 1) {
          currentPage++;
          renderCurrentPage();
        }
      };
      
      // Update dots
      const dotsContainer = document.getElementById('page-dots');
      dotsContainer.innerHTML = '';
      
      for (let i = 0; i < totalPages && i < 5; i++) { // Limit to 5 dots
        const dot = document.createElement('button');
        dot.className = `page-dot ${i === currentPage ? 'active' : ''}`;
        dot.onclick = () => {
          currentPage = i;
          renderCurrentPage();
        };
        dotsContainer.appendChild(dot);
      }
      
      // Update info
      const pageInfo = document.getElementById('page-info');
      const startItem = currentPage * itemsPerPage + 1;
      const endItem = Math.min((currentPage + 1) * itemsPerPage, filteredItems.length);
      pageInfo.textContent = `${startItem}-${endItem} / ${filteredItems.length}`;
    }

    // Initialize sort controls
    function initSortControls() {
      const sortBtns = document.querySelectorAll('.sort-btn');
      
      sortBtns.forEach(btn => {
        btn.addEventListener('click', () => {
          // Update active state
          sortBtns.forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          
          // Apply sort
          const sortType = btn.dataset.sort;
          applySort(sortType);
          renderCurrentPage();
        });
      });
    }

    // Korean particles effect
    function initKoreanParticles() {
      if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;
      
      const container = document.getElementById('korean-particles');
      let particleCount = 0;
      const maxParticles = 12;
      
      function createParticle() {
        if (particleCount >= maxParticles) return;
        
        const particle = document.createElement('div');
        particle.className = 'korean-particle';
        particle.textContent = koreanChars[Math.floor(Math.random() * koreanChars.length)];
        
        particle.style.left = Math.random() * 100 + 'vw';
        particle.style.fontSize = (Math.random() * 0.5 + 0.8) + 'rem';
        particle.style.animationDelay = Math.random() * 8 + 's';
        
        container.appendChild(particle);
        particleCount++;
        
        setTimeout(() => {
          particle.remove();
          particleCount--;
        }, 8000);
      }
      
      // Create particles periodically
      setInterval(() => {
        if (!document.hidden) {
          createParticle();
        }
      }, 1000);
    }

    // Touch support for mobile
    function initTouchSupport() {
      if (!('ontouchstart' in window)) return;
      
      let startX = 0;
      const grid = document.getElementById('treasure-grid');
      
      grid.addEventListener('touchstart', (e) => {
        startX = e.touches[0].clientX;
      }, { passive: true });
      
      grid.addEventListener('touchend', (e) => {
        const endX = e.changedTouches[0].clientX;
        const diffX = startX - endX;
        
        // Swipe threshold
        if (Math.abs(diffX) > 50) {
          if (diffX > 0) {
            // Swipe left - next page
            const nextBtn = document.getElementById('next-btn');
            if (!nextBtn.disabled) nextBtn.click();
          } else {
            // Swipe right - previous page
            const prevBtn = document.getElementById('prev-btn');
            if (!prevBtn.disabled) prevBtn.click();
          }
        }
      }, { passive: true });
    }
  </script>
</body>
</html>